!function(){"use strict";function t(){}function e(t){return t()}function n(){return Object.create(null)}function o(t){t.forEach(e)}function r(t){return"function"==typeof t}function s(t,e){return t!=t?e==e:t!==e||t&&"object"==typeof t||"function"==typeof t}function i(t,e){t.appendChild(e)}function l(t,e,n){t.insertBefore(e,n||null)}function a(t){t.parentNode.removeChild(t)}function c(t){return document.createElement(t)}function u(t){return document.createTextNode(t)}function f(){return u(" ")}function d(){return u("")}function m(t,e,n,o){return t.addEventListener(e,n,o),()=>t.removeEventListener(e,n,o)}function p(t){return function(e){return e.preventDefault(),t.call(this,e)}}function h(t,e,n){null==n?t.removeAttribute(e):t.getAttribute(e)!==n&&t.setAttribute(e,n)}function g(t,e){e=""+e,t.wholeText!==e&&(t.data=e)}function w(t,e){t.value=null==e?"":e}function $(t,e,n,o){t.style.setProperty(e,n,o?"important":"")}let b;function v(t){b=t}function y(){if(!b)throw new Error("Function called outside component initialization");return b}const x=[],k=[],_=[],q=[],E=Promise.resolve();let j=!1;function M(t){_.push(t)}function S(t){q.push(t)}let A=!1;const O=new Set;function C(){if(!A){A=!0;do{for(let t=0;t<x.length;t+=1){const e=x[t];v(e),N(e.$$)}for(v(null),x.length=0;k.length;)k.pop()();for(let t=0;t<_.length;t+=1){const e=_[t];O.has(e)||(O.add(e),e())}_.length=0}while(x.length);for(;q.length;)q.pop()();j=!1,A=!1,O.clear()}}function N(t){if(null!==t.fragment){t.update(),o(t.before_update);const e=t.dirty;t.dirty=[-1],t.fragment&&t.fragment.p(t.ctx,e),t.after_update.forEach(M)}}const T=new Set;let J;function z(){J={r:0,c:[],p:J}}function L(){J.r||o(J.c),J=J.p}function F(t,e){t&&t.i&&(T.delete(t),t.i(e))}function P(t,e,n,o){if(t&&t.o){if(T.has(t))return;T.add(t),J.c.push((()=>{T.delete(t),o&&(n&&t.d(1),o())})),t.o(e)}}function B(t,e){const n=e.token={};function o(t,o,r,s){if(e.token!==n)return;e.resolved=s;let i=e.ctx;void 0!==r&&(i=i.slice(),i[r]=s);const l=t&&(e.current=t)(i);let a=!1;e.block&&(e.blocks?e.blocks.forEach(((t,n)=>{n!==o&&t&&(z(),P(t,1,1,(()=>{e.blocks[n]===t&&(e.blocks[n]=null)})),L())})):e.block.d(1),l.c(),F(l,1),l.m(e.mount(),e.anchor),a=!0),e.block=l,e.blocks&&(e.blocks[o]=l),a&&C()}if((r=t)&&"object"==typeof r&&"function"==typeof r.then){const n=y();if(t.then((t=>{v(n),o(e.then,1,e.value,t),v(null)}),(t=>{if(v(n),o(e.catch,2,e.error,t),v(null),!e.hasCatch)throw t})),e.current!==e.pending)return o(e.pending,0),!0}else{if(e.current!==e.then)return o(e.then,1,e.value,t),!0;e.resolved=t}var r}function D(t,e){t.d(1),e.delete(t.key)}function I(t,e){P(t,1,1,(()=>{e.delete(t.key)}))}function R(t,e,n,o,r,s,i,l,a,c,u,f){let d=t.length,m=s.length,p=d;const h={};for(;p--;)h[t[p].key]=p;const g=[],w=new Map,$=new Map;for(p=m;p--;){const t=f(r,s,p),l=n(t);let a=i.get(l);a?o&&a.p(t,e):(a=c(l,t),a.c()),w.set(l,g[p]=a),l in h&&$.set(l,Math.abs(p-h[l]))}const b=new Set,v=new Set;function y(t){F(t,1),t.m(l,u),i.set(t.key,t),u=t.first,m--}for(;d&&m;){const e=g[m-1],n=t[d-1],o=e.key,r=n.key;e===n?(u=e.first,d--,m--):w.has(r)?!i.has(o)||b.has(o)?y(e):v.has(r)?d--:$.get(o)>$.get(r)?(v.add(o),y(e)):(b.add(r),d--):(a(n,i),d--)}for(;d--;){const e=t[d];w.has(e.key)||a(e,i)}for(;m;)y(g[m-1]);return g}function W(t,e,n){const o=t.$$.props[e];void 0!==o&&(t.$$.bound[o]=n,n(t.$$.ctx[o]))}function K(t){t&&t.c()}function U(t,n,s,i){const{fragment:l,on_mount:a,on_destroy:c,after_update:u}=t.$$;l&&l.m(n,s),i||M((()=>{const n=a.map(e).filter(r);c?c.push(...n):o(n),t.$$.on_mount=[]})),u.forEach(M)}function H(t,e){const n=t.$$;null!==n.fragment&&(o(n.on_destroy),n.fragment&&n.fragment.d(e),n.on_destroy=n.fragment=null,n.ctx=[])}function G(t,e){-1===t.$$.dirty[0]&&(x.push(t),j||(j=!0,E.then(C)),t.$$.dirty.fill(0)),t.$$.dirty[e/31|0]|=1<<e%31}function Q(e,r,s,i,l,c,u=[-1]){const f=b;v(e);const d=e.$$={fragment:null,ctx:null,props:c,update:t,not_equal:l,bound:n(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(f?f.$$.context:r.context||[]),callbacks:n(),dirty:u,skip_bound:!1};let m=!1;if(d.ctx=s?s(e,r.props||{},((t,n,...o)=>{const r=o.length?o[0]:n;return d.ctx&&l(d.ctx[t],d.ctx[t]=r)&&(!d.skip_bound&&d.bound[t]&&d.bound[t](r),m&&G(e,t)),n})):[],d.update(),m=!0,o(d.before_update),d.fragment=!!i&&i(d.ctx),r.target){if(r.hydrate){const t=function(t){return Array.from(t.childNodes)}(r.target);d.fragment&&d.fragment.l(t),t.forEach(a)}else d.fragment&&d.fragment.c();r.intro&&F(e.$$.fragment),U(e,r.target,r.anchor,r.customElement),C()}v(f)}class V{$destroy(){H(this,1),this.$destroy=t}$on(t,e){const n=this.$$.callbacks[t]||(this.$$.callbacks[t]=[]);return n.push(e),()=>{const t=n.indexOf(e);-1!==t&&n.splice(t,1)}}$set(t){var e;this.$$set&&(e=t,0!==Object.keys(e).length)&&(this.$$.skip_bound=!0,this.$$set(t),this.$$.skip_bound=!1)}}const X=new Map;let Y="Deno"in window?window.Deno:void 0;function Z(t){return t&&t.toJSON?t.toJSON():t}const tt=[];let et,nt=0,ot=!1;function rt(){ot||(ot=!0,setTimeout((async()=>{for(;nt<tt.length;){let{name:t,test:e}=tt[nt];nt+=1;try{console.log(`  test | ${t}`);let n=e();n&&await n}catch(e){if(console.error(`  test | ${t} failed`),console.error(e),null!=Y)throw e}}ot=!1}),0))}window.runTests=rt;try{et=(function(t,e){if(!X.has(t))try{X.set(t,Deno.env.get(t))}catch(e){X.set(t,void 0)}const n=X.get(t)||e;if(null==n)throw new Error(`env var '${t}' is not defined`);return n}("test")||"").toLowerCase()}catch(t){et="false"}let st="all"==et||"true"==et;function it(t,e){tt.push({name:t,test:e}),(st||t.toLowerCase()==et)&&rt()}const lt=function(t,e){const n=e?e instanceof Function?e():e:"Assertion error!";if(!t)throw new Error(n)};function at(t){return null===t||"object"!=typeof t?t:Array.isArray(t)?t.map(at):"toJSON"in t?at(t.toJSON()):Object.assign({},...Object.entries(t).sort((([t],[e])=>t.localeCompare(e))).map((([t,e])=>({[t]:at(e)}))))}function ct(t,e=!0){return e?JSON.stringify(at(t),null,2):JSON.stringify(at(t))}function ut(t,e){return null===(t=e(t))||"object"!=typeof t?t:"map"in t?t.map((t=>ut(t,e))):Object.assign({},...Object.entries(t).map((([t,n])=>({[t]:ut(n,e)}))))}function ft(t,e){const n=e.match(t);return n?1==n.length?[]:n.slice(1,n.length):[]}function dt(t,e){if(t instanceof Array)for(let n=0;n<t.length;n++)e(t[n],n);else if(t instanceof Map)for(const[n,o]of t)e(o,n);else for(const n in t)t.hasOwnProperty(n)&&e(t[n],n)}function mt(t,e){const n=e instanceof Function?e:t=>t==e;if(t instanceof Array)for(let e=0;e<t.length;e++){if(n(t[e],e))return t[e];for(const e in t)if(t.hasOwnProperty(e)&&n(t[e],e))return t[e]}}function pt(t,e){if(e=e||(t=>t),0==t.length)return-1;let n=e(t[0]),o=0;for(let r=1;r<t.length;r++){let s=e(t[r]);s<n&&(n=s,o=r)}return o}function ht(t,e){if(e=e||(t=>t),0==t.length)return-1;let n=e(t[0]),o=0;for(let r=1;r<t.length;r++){let s=e(t[r]);s>n&&(n=s,o=r)}return o}function gt(t,e=!1){return wt(t,.5,e)}function wt(t,e,n=!1){const o=n?t:[...t].sort(((t,e)=>t-e)),r=(o.length-1)*e,s=Math.floor(r),i=r-s;return void 0!==o[s+1]?o[s]+i*(o[s+1]-o[s]):o[s]}function $t(t,e){const n=[];let o=0;for(;;){const r=[];o<t.length&&n.push(r);for(let s=0;s<e;s++){if(!(o+s<t.length))return n;r.push(t[o+s])}o+=e}}function bt(t,e){if(t instanceof Array){const n=new Array,o=new Array,r=e instanceof Function?e:(t,n)=>e.includes(n);return dt(t,((t,e)=>r(t,e)?n.push(t):o.push(t))),[n,o]}{const n={},o={},r=e instanceof Function?e:(t,n)=>e.includes(n);return dt(t,((t,e)=>r(t,e)?n[e]=t:o[e]=t)),[n,o]}}function vt(t,e,n=!1){if(0==t.length)return t;{const o=typeof e(t[0]);let r,s;if("number"==o)r=function(t,n){return e(t)-e(n)};else if("boolean"==o)r=function(t,n){return(e(t)?1:0)-(e(n)?1:0)};else{if("string"!=o)throw new Error(`invalid return type for 'by' '${o}'`);r=function(t,n){return e(t).localeCompare(e(n))}}return s=[...t],s.sort(r),n&&s.reverse(),s}}function yt(t,e){if("object"==typeof t&&"found"in t){if(t.found)return t.value;throw new Error(t.message||`value${e?" "+e:""} not found`)}if("string"==typeof t){if(""==t)throw new Error(`string value${e?" "+e:""} not found`);return t}if(void 0===t)throw new Error(`value${e?" "+e:""} not defined`);return t}function xt(t,e,n){return dt(t,((t,o)=>e=n(e,t,o))),e}function kt(t){return xt(t,0,((t,e)=>t+e))}function _t(t,e){if(t instanceof Array)return t.map(e);if(t instanceof Map){const n=new Map;return dt(t,((t,o)=>n.set(o,e(t,o)))),n}{const n={};return dt(t,((t,o)=>n[o]=e(t,o))),n}}function qt(t,e=0){return 0==e?Math.round(t):Math.round((t+Number.EPSILON)*Math.pow(10,e))/Math.pow(10,e)}function Et(t){switch(t){case"left":return"text-left";case"center":return"text-center";case"right":return"text-right"}}function jt(e){let n,o;return{c(){n=c("div"),o=u(e[0]),h(n,"class",e[1])},m(t,e){l(t,n,e),i(n,o)},p(t,[e]){1&e&&g(o,t[0])},i:t,o:t,d(t){t&&a(n)}}}lt.equal=(t,e,n)=>{if(!function(t,e){return ct(t)===ct(e)}(t,e)){const o=n?n instanceof Function?n():n:`Assertion error: ${ct(t,!0)} != ${ct(e,!0)}`;throw new Error(o)}},lt.fail=(t,e)=>{let n=!1;try{t()}catch(t){n=!0}if(!n){const t=e?e instanceof Function?e():e:"Assertion error: expected to fail but didn't";throw new Error(t)}},lt.approxEqual=(t,e,n,o)=>{o=o||.001;const r=(Math.abs(t)+Math.abs(e))/2*o;if(Math.abs(t-e)>r){const o=n?n instanceof Function?n():n:`Assertion error: ${ct(t,!0)} != ${ct(e,!0)}`;throw new Error(o)}},it("deepMap",(()=>{class t{constructor(t){this.v=t}toJSON(){return this.v}}const e=new t([1,2]);lt.equal(ut(e,Z),[1,2]);const n=new t([e,3]);lt.equal(ut(n,Z),[[1,2],3])})),Promise.prototype.toJSON=function(){return"Promise"},Object.defineProperty(Promise.prototype,"cmap",{configurable:!1,enumerable:!1}),it("parse",(()=>{lt.equal(ft(/.+ (\d+) (\d+)/,"a 22 45"),["22","45"]),lt.equal(ft(/[^;]+;/,"drop table; create table;"),[])})),it("parseNamed",(()=>{lt.equal(function(t,e){const n=e.match(t);return(null==n?void 0:n.groups)||{}}(/.+ (?<a>\d+) (?<b>\d+)/,"a 22 45"),{a:"22",b:"45"})})),it("dedent",(()=>{lt.equal(function(t){const e=ft(/^(\s+)/,t=t.replace(/^\n*/,""));return 0==e.length?t:t.replace(new RegExp("^\\s{"+e[0].length+"}","gm"),"")}("\n  a\n  b\n    c"),"a\nb\n  c")})),it("groupByN",(()=>{lt.equal($t([1,2,3],2),[[1,2],[3]]),lt.equal($t([1,2],2),[[1,2]]),lt.equal($t([1],2),[[1]]),lt.equal($t([],2),[])})),it("sortBy",(()=>{lt.equal(vt([{v:!0},{v:!1}],(({v:t})=>t)),[{v:!1},{v:!0}]),lt.equal(vt([{v:"b"},{v:""},{v:"c"}],(({v:t})=>t)),[{v:""},{v:"b"},{v:"c"}])})),it("pick",(()=>{var t;lt.equal((t=["a"],bt({a:1,b:2},((e,n)=>t.includes(n)))[0]),{a:1})})),it("round",(()=>{lt.equal(qt(.05860103881518906,2),.06)})),Error.prototype.toJSON=function(){return{message:this.message,stack:this.stack}},Map.prototype.toJSON=function(){return xt(this,{},((t,e,n)=>(t[n]=e,t)))};function Mt(t,e,n){let o,{options:r}=e,{value:s}=e;const i=Et(r.align||"left")+(r.small?" text-xs":"");return t.$$set=t=>{"options"in t&&n(2,r=t.options),"value"in t&&n(3,s=t.value)},t.$$.update=()=>{8&t.$$.dirty&&n(0,o=null==s?"":s)},[o,i,r,s]}var St=Object.freeze({__proto__:null,default:class extends V{constructor(t){super(),Q(this,t,Mt,jt,s,{options:2,value:3})}},compatibleTypes:["number","boolean","string"],align:function(t){return t.align||"left"}});function At(e){let n,o,r=(e[0]?e[2]:e[3])+"";return{c(){n=c("div"),o=u(r),h(n,"class",e[1])},m(t,e){l(t,n,e),i(n,o)},p(t,[e]){1&e&&r!==(r=(t[0]?t[2]:t[3])+"")&&g(o,r)},i:t,o:t,d(t){t&&a(n)}}}function Ot(t,e,n){let{options:o}=e,{value:r}=e;const s=Et(o.align||"center"),i=o.true||"✓",l=o.false||"";return t.$$set=t=>{"options"in t&&n(4,o=t.options),"value"in t&&n(0,r=t.value)},[r,s,i,l,o]}var Ct=Object.freeze({__proto__:null,default:class extends V{constructor(t){super(),Q(this,t,Ot,At,s,{options:4,value:0})}},compatibleTypes:["boolean"],align:function(t){return t.align||"center"}});function Nt(e){let n,o;return{c(){n=c("div"),o=u(e[0]),h(n,"class",e[1])},m(t,e){l(t,n,e),i(n,o)},p(t,[e]){1&e&&g(o,t[0])},i:t,o:t,d(t){t&&a(n)}}}function Tt(t,e,n){let o,{options:r}=e,{value:s}=e;const i="round"in r?r.round:2,l=Et(r.align||"right")+(r.small?" text-xs":"");return t.$$set=t=>{"options"in t&&n(2,r=t.options),"value"in t&&n(3,s=t.value)},t.$$.update=()=>{8&t.$$.dirty&&n(0,o=void 0===s?"":""+(void 0!==i?s.toFixed(i):s))},[o,l,r,s]}var Jt=Object.freeze({__proto__:null,default:class extends V{constructor(t){super(),Q(this,t,Tt,Nt,s,{options:2,value:3})}},compatibleTypes:["number"],align:function(t){return t.align||"right"}});function zt(t,e,n){const o=t.slice();return o[5]=e[n],o}function Lt(t){let e,n,o,r=[],s=new Map,u=t[0].ticks;const d=t=>t[5];for(let e=0;e<u.length;e+=1){let n=zt(t,u,e),o=d(n);s.set(o,r[e]=Ft(o,n))}return{c(){e=c("div");for(let t=0;t<r.length;t+=1)r[t].c();n=f(),o=c("div"),h(o,"class","absolute "+t[2]+" h-2"),$(o,"left","0"),$(o,"top","-0.25rem"),$(o,"width",100*t[0].value+"%"),$(o,"background-color",Bt),$(o,"border-radius","2px"),h(o,"title",t[1]),h(e,"class","relative")},m(t,s){l(t,e,s);for(let t=0;t<r.length;t+=1)r[t].m(e,null);i(e,n),i(e,o)},p(t,i){7&i&&(u=t[0].ticks,r=R(r,i,d,1,t,u,s,e,D,Ft,n,zt)),1&i&&$(o,"width",100*t[0].value+"%"),2&i&&h(o,"title",t[1])},d(t){t&&a(e);for(let t=0;t<r.length;t+=1)r[t].d()}}}function Ft(t,e){let n;return{key:t,first:null,c(){n=c("div"),h(n,"class","absolute "+e[2]+" h-1"),$(n,"left","0"),$(n,"top","-0.5rem"),$(n,"width",100*e[5]+"%"),$(n,"border-right","1px solid "+Dt),h(n,"title",e[1]),this.first=n},m(t,e){l(t,n,e)},p(t,o){e=t,1&o&&$(n,"width",100*e[5]+"%"),2&o&&h(n,"title",e[1])},d(t){t&&a(n)}}}function Pt(e){let n,o=null!=e[0]&&Lt(e);return{c(){o&&o.c(),n=d()},m(t,e){o&&o.m(t,e),l(t,n,e)},p(t,[e]){null!=t[0]?o?o.p(t,e):(o=Lt(t),o.c(),o.m(n.parentNode,n)):o&&(o.d(1),o=null)},i:t,o:t,d(t){o&&o.d(t),t&&a(n)}}}const Bt="#111827",Dt="#6B7280";function It(t,e,n){let o,{options:r}=e,{value:s}=e,{converted:i}=e;const l=Et(r.align||"left");return t.$$set=t=>{"options"in t&&n(3,r=t.options),"value"in t&&n(4,s=t.value),"converted"in t&&n(0,i=t.converted)},t.$$.update=()=>{25&t.$$.dirty&&n(1,o=i?`value: ${s}`+(r.ticks&&r.ticks.length>0?`, ticks: ${(r.ticks||[]).join(", ")}`:""):"")},[i,o,l,r,s]}var Rt=Object.freeze({__proto__:null,default:class extends V{constructor(t){super(),Q(this,t,It,Pt,s,{options:3,value:4,converted:0})}},compatibleTypes:["number"],align:function(t){return t.align||"center"},convertColumn:function(t,e){const n=new Set;let o=0;for(const e of t)void 0!==e&&e>o&&(o=e);for(const t of e.ticks||[])void 0!==t&&t>o&&(o=t);e.max&&(e.max>=o?o=e.max:n.add(`max value for 'line' format ${e.max} is smaller than actual max ${o}`)),0==o&&(o=1);const r=(e.ticks||[]).map((t=>t<0?(n.add("negative values not supported for 'ticks' for 'line' format"),0):t/o));return{column:t.map((t=>{if(void 0!==t){if(!(t<0))return{value:t/o,ticks:r};n.add("negative values not supported for 'line' format")}})),warnings:Array.from(n).sort()}}});function Wt(e){let n,o;return{c(){n=c("div"),o=u(e[0]),h(n,"class",e[1])},m(t,e){l(t,n,e),i(n,o)},p(t,[e]){1&e&&g(o,t[0])},i:t,o:t,d(t){t&&a(n)}}}function Kt(t,e,n){let o,{options:r}=e,{value:s}=e;const i=Et(r.align||"left")+(r.small?" text-xs":"");return t.$$set=t=>{"options"in t&&n(2,r=t.options),"value"in t&&n(3,s=t.value)},t.$$.update=()=>{8&t.$$.dirty&&n(0,o=null==s?"":""+s)},[o,i,r,s]}const Ut={string:St,boolean:Ct,number:Jt,unknown:Object.freeze({__proto__:null,default:class extends V{constructor(t){super(),Q(this,t,Kt,Wt,s,{options:2,value:3})}},compatibleTypes:[],align:function(t){return t.align||"left"}}),line:Rt};function Ht(t){return t in Ut?{isError:!1,value:Ut[t]}:{isError:!0,message:`no '${t}' format`}}const Gt=["string","number","boolean","unknown"];function Qt(t,e,n,o){if(0==n.length)return{columns:[],rows:[],formats:[],messages:[]};const r=[];for(let e=0;e<n.length;e++){const o=n[e];if(Array.isArray(o)){const n={_i:e};if(t)for(let e=0;e<t.length&&e<o.length;e++)n[t[e].id]=o[e];else for(let t=0;t<Vt.length&&t<o.length;t++)n[Vt[t]]=o[t];r.push(n)}else r.push(Object.assign(Object.assign({},o),{_i:e}))}for(let t=0;t<r.length;t++){const e=r[t];for(const t in e)null===e[t]&&(e[t]=void 0)}const s=new Set;if(!t){const e=new Map,n=new Set;for(let t=0;t<r.length;t++){const o=r[t];for(const t in o){if("_i"==t)continue;let r=o[t];if(void 0===r)n.add(t);else{let n=typeof r;"object"==n?(s.add(`unknown type for column '${t}' - '${n}'`),e.set(t,"unknown")):e.has(t)?e.get(t)!=n&&(s.add(`unstable types for column '${t}', ${[e.get(t),n].sort().join(", ")}`),e.set(t,"unknown")):e.set(t,n)}}}for(const t of n)e.has(t)||e.set(t,"unknown");t=vt(Array.from(e,(([t,e])=>({id:t,type:e}))),(({id:t})=>t))}if(e){const n=e.map((({id:t})=>t));t=[...e,...t.filter((({id:t})=>!n.includes(t)))]}const i=new Map;for(const e of t){const{id:t}=e;i.has(t)&&(s.add(`not unique column id '${t}'`),e.id=t+i.get(t)),i.set(t,(i.get(t)||0)+1)}t=[...t];for(let e=0;e<r.length;e++){const n=r[e];for(const e of t){const{id:t,type:o}=e;if("_i"==t)continue;let r=n[t];if(void 0===r)continue;typeof r!=o&&"unknown"!=o&&Gt.includes(o)&&(s.add(`wrong type for column '${t}', specified as '${o}' but '${typeof r}' found`),e.type="unknown")}}for(const{id:e,min_max:n,type:o}of t){if(!n)continue;if("number"!=o){s.add(`wrong min_max on column '${e}' it can't be specified for non integer type '${o}'`);continue}const[t,i]=n;t>i&&s.add(`wrong min_max on column '${e}' min should not be greather than max`);for(const n of r){const o=n[e];null!=o&&(o<t&&s.add(`wrong min_max on column '${e}' column contains values lover than '${t}'`),o>i&&s.add(`wrong min_max on column '${e}' column contains values greater than '${t}'`))}}o&&t.unshift({id:"_i",type:"number"});const l=Ht("unknown");if(l.isError)throw"can't get 'unknown' formatter";const a=[];for(const e of t){const t=e.format||{type:e.type},n=Ht(t.type);n.isError?(s.add(n.message),a.push([l.value,t])):n.value.compatibleTypes.includes(e.type)?a.push([n.value,t]):(s.add(`column ${e.id} has wrong format, format ${e.format} is not compatible with '${e.type}' type`),a.push([l.value,t]))}for(let e=0;e<t.length;e++){const[{id:n},[o,i]]=[t[e],a[e]];if(o.convertColumn){const t=r.map((t=>t[n])),{column:e,warnings:l}=o.convertColumn(t,i);l.forEach((t=>s.add(t)));for(let t=0;t<r.length;t++){const o=r[t];o._converted||(o._converted={}),o._converted[n]=e[t]}}}return{columns:t,rows:r,formats:a,messages:Array.from(s).sort().map((t=>({type:"warn",message:t})))}}const Vt="abcdefghijklmnopqrstuvwxyz".split("");function Xt(t,e){let n;if(t.some((({width:t})=>null!=t)))n=t.map((({width:t})=>t||1));else{const o=new Map;for(const n of e)for(const{id:e,type:r}of t){let t;if(void 0===n[e])continue;if("string"==r)t=n[e].length;else if("number"==r)t=(""+n[e]).length;else{if("boolean"!=r)continue;t=1}let s=o.get(e);null==s&&(s=[],o.set(e,s)),s.push(t)}const r=_t(o,(t=>wt(t,.7))),s=gt(xt(r,[],((t,e)=>(t.push(e),t)))),i=1.618,l=_t(r,(t=>t>s*i?i:t<s/i?1/i:1)),a=1;n=t.map((({id:t})=>l.get(t)||a))}return Yt(n)}function Yt(t){const e=100/kt(t);let n=t.map((t=>qt(t*e)));for(;;){const t=kt(n);if(t>100)n[ht(n)]-=1;else{if(!(t<100))break;n[pt(n)]+=1}}return n}function Zt(t,e,n){if(!(n=function(t){return t.replace(/^[\t\s\n]+|[\t\s\n]+$/g,"")}(n)))return e;const o=/^([^=\s]+)=(.+)$/i;if(o.test(n)){const[t,r]=function(t,e){const n=ft(t,e);if(2!=n.length)throw new Error(`expected 2 matches but found ${n.length}`);return[n[0],n[1]]}(o,n),s=r.toLowerCase();return e.filter((e=>(""+e[t]).toLowerCase().includes(s)))}{const o=n.toLowerCase();return e.filter((e=>{for(const{id:n}of t)if((""+e[n]).toLowerCase().includes(o))return!0;return!1}))}}it("normalizeInputsSlow",(()=>{{const{columns:t,rows:e}=Qt(void 0,void 0,[["v",null]],!1);lt.equal(t,[{id:"a",type:"string"},{id:"b",type:"unknown"}]),lt.equal(e,[{a:"v",b:void 0,_i:0}])}{const{columns:t,rows:e}=Qt(void 0,void 0,[{k:"v",k2:null}],!1);lt.equal(t,[{id:"k",type:"string"},{id:"k2",type:"unknown"}]),lt.equal(e,[{k:"v",k2:void 0,_i:0}])}{const{columns:t,rows:e}=Qt(void 0,void 0,[{k:"v"},{k:0}],!1);lt.equal(t,[{id:"k",type:"unknown"}]),lt.equal(e,[{k:"v",_i:0},{k:0,_i:1}])}})),it("calculateColumnWidths",(()=>{lt.equal(Xt([{id:"name",type:"string"},{id:"age",type:"number"}],[{name:"Jim Raynor",age:30},{name:"Kate",age:25}]),[62,38])})),it("weightsToPercents",(()=>{lt.equal(Yt([2,2]),[50,50]),lt.equal(Yt([3,3,3]).sort(),[33,33,34])}));const te={string:function(t,e){return t.localeCompare(e)},number:function(t,e){return t-e},boolean:function(t,e){return t==e?0:t?1:-1},unknown:function(t,e){return(""+t).localeCompare(""+e)}};function ee(t,[e,n]){const o="desc"==n,r=yt(mt(t,(({id:t})=>t==e))).type;if(!(r in te))throw new Error(`no comparator for '${r}' type, please register one`);const s=te[r];return o?function(t,n){const o=n[e],r=t[e];return void 0===o?void 0===r?0:-1:void 0===r?1:s(o,r)}:function(t,n){const o=t[e],r=n[e];return void 0===o?void 0===r?0:-1:void 0===r?1:s(o,r)}}function ne(t,e,n){if(n.length>3)throw new Error("sort not supported for more than 3 columns");const[o,r,s]=n;if(null==o&&lt(null==r),null==r&&lt(null==s),0==e.length||null==o)return e;let i,l=ee(t,o),a=r?ee(t,r):void 0,c=s?ee(t,s):void 0;i=c?function(t,e){let n=l(t,e);return 0!=n?n:(n=a(t,e),0!=n?n:c(t,e))}:a?function(t,e){let n=l(t,e);return 0!=n?n:a(t,e)}:l;const u=[...e];return u.sort(i),u}function oe(t,e,n){e=[...e];for(const t of e)t._weights={},t._nweights={};for(const[o,r]of n){const{type:n,min_max:s}=yt(mt(t,(({id:t})=>t==o)));let[i,l]=bt(e,(t=>void 0!==t[o]));if(0==i.length){for(const t of e)t._weights[o]=0,t._nweights[o]=0;continue}if("number"==n){const t=typeof e[0][o];if("number"!=t)throw new Error(`wrong type for '${o}' column, wsort expects number but found '${t}'`);for(const t of i)t._weights[o]=t[o]}else{if(!(n in te))throw new Error(`no comparator for '${n}' type, please register one`);const t=te[n];i.sort(((e,n)=>t(e[o],n[o])));let e,r=0;for(let t=0;t<i.length;t++){const n=i[t];n[o]==e?r+=1:e=n[o],n._weights[o]=t-r}}{let t,e;if(s){if("number"!=n)throw new Error("can't use min_max for non number type");t=s[0],e=s[1]}else{const n=i.map((t=>t._weights[o]));t=Math.min(...n),e=Math.max(...n)}const r=(e+t)/2;let l=(e-t)/2;lt(l>=0),l=0==l?1:l;for(const t of i){let e=(t._weights[o]-r)/l;t._nweights[o]=e}}let a=gt(i.map((t=>t._nweights[o])));for(const t of l)t._nweights[o]=a;if("desc"==r)for(const t of e)t._nweights[o]=-1*t._nweights[o]}for(const t of e){let e=0;for(const[o,r]of n)e+=t._nweights[o];t._w=e}return e.sort(((t,e)=>t._w-e._w)),e}function re(t){let e,n,o,r,s,d,w,b,v,y,x=t[2].symbol+"";return{c(){e=c("th"),n=c("a"),o=c("span"),r=u(x),d=f(),w=c("span"),b=u(t[1]),h(o,"class",s=t[2].klass),h(n,"class","flex justify-between"),h(n,"href","#"),$(e,"width",t[0]+"%"),h(e,"class","text-right")},m(s,a){l(s,e,a),i(e,n),i(n,o),i(o,r),i(n,d),i(n,w),i(w,b),v||(y=m(n,"click",p(t[4])),v=!0)},p(t,n){4&n&&x!==(x=t[2].symbol+"")&&g(r,x),4&n&&s!==(s=t[2].klass)&&h(o,"class",s),2&n&&g(b,t[1]),1&n&&$(e,"width",t[0]+"%")},d(t){t&&a(e),v=!1,y()}}}function se(t){let e,n,o,r,s,d,w,b,v,y,x,k,_,q=t[2].symbol+"",E=t[2].symbol+"";return{c(){e=c("th"),n=c("a"),o=c("span"),r=u(q),s=f(),d=c("span"),w=u(t[1]),b=f(),v=c("span"),y=u(E),h(o,"class","invisible"),h(v,"class",x=t[2].klass),h(n,"class","flex justify-between"),h(n,"href","#"),$(e,"width",t[0]+"%")},m(a,c){l(a,e,c),i(e,n),i(n,o),i(o,r),i(n,s),i(n,d),i(d,w),i(n,b),i(n,v),i(v,y),k||(_=m(n,"click",p(t[4])),k=!0)},p(t,n){4&n&&q!==(q=t[2].symbol+"")&&g(r,q),2&n&&g(w,t[1]),4&n&&E!==(E=t[2].symbol+"")&&g(y,E),4&n&&x!==(x=t[2].klass)&&h(v,"class",x),1&n&&$(e,"width",t[0]+"%")},d(t){t&&a(e),k=!1,_()}}}function ie(t){let e,n,o,r,s,d,w,b,v,y,x=t[2].symbol+"";return{c(){e=c("th"),n=c("a"),o=c("span"),r=u(t[1]),s=f(),d=c("span"),w=u(x),h(d,"class",b=t[2].klass),h(n,"class","flex justify-between"),h(n,"href","#"),$(e,"width",t[0]+"%")},m(a,c){l(a,e,c),i(e,n),i(n,o),i(o,r),i(n,s),i(n,d),i(d,w),v||(y=m(n,"click",p(t[4])),v=!0)},p(t,n){2&n&&g(r,t[1]),4&n&&x!==(x=t[2].symbol+"")&&g(w,x),4&n&&b!==(b=t[2].klass)&&h(d,"class",b),1&n&&$(e,"width",t[0]+"%")},d(t){t&&a(e),v=!1,y()}}}function le(e){let n;let o=function(t,e){return"left"==t[3]?ie:"center"==t[3]?se:re}(e)(e);return{c(){o.c(),n=d()},m(t,e){o.m(t,e),l(t,n,e)},p(t,[e]){o.p(t,e)},i:t,o:t,d(t){o.d(t),t&&a(n)}}}function ae(t,e,n){let o,r,s,{column:i}=e,{format:l}=e,{width:a}=e,{state:c}=e,u=i.id;const f=l[0].align(l[1]);return t.$$set=t=>{"column"in t&&n(6,i=t.column),"format"in t&&n(7,l=t.format),"width"in t&&n(0,a=t.width),"state"in t&&n(5,c=t.state)},t.$$.update=()=>{64&t.$$.dirty&&n(1,o=i.title||i.id),32&t.$$.dirty&&n(8,r=function(t){for(let e=0;e<t.length;e++){const[n,o]=t[e];if(n==u)return[o,e]}}(c.order)),288&t.$$.dirty&&n(2,s=function(t,e,n){if(!t)return{symbol:"↓",klass:"invisible"};if(e){const[e,n]=t;return{symbol:"asc"==e?"↓":"↑",klass:"text-gray-400"}}{const[e,n]=t,o="asc"==e?"↓":"↑";let r;if(0==n)r="";else if(1==n)r="text-gray-400";else{if(2!=n)throw new Error("color for more than 3 sort oders isn't supported");r="text-gray-300"}return{symbol:o,klass:r}}}(r,c.wsort,c.order.length))},[a,o,s,f,function(t){if(c.sortable)if(t.metaKey)n(5,c.order=r?c.order.map((([t,e])=>[t,t==u?"asc"==e?"desc":"asc":e])):[...c.order,[u,"asc"]],c);else{let t;t=c.order.length>1?"asc":r&&"asc"==r[0]?"desc":"asc",n(5,c.order=[[u,t]],c)}},c,i,l,r]}it("sortTable",(()=>{const t=[{id:"name",type:"string"},{id:"age",type:"number"}],e=[{name:"Artanis",age:200},{name:"Sarah",age:30},{name:"Jim",age:30},{name:"Amon",age:void 0}];let n=n=>ne(t,e,n).map((({name:t})=>t));lt.equal(n([["name","asc"]]),["Amon","Artanis","Jim","Sarah"]),lt.equal(n([["age","asc"]])[0],"Amon"),lt.equal(n([["age","asc"],["name","asc"]]),["Amon","Jim","Sarah","Artanis"])})),it("wsortTable",(()=>{let t=(t,e,n)=>oe(t,e,n).map((({id:t})=>t));lt.equal(t([{id:"a",type:"number"},{id:"b",type:"number"}],[{id:"a",a:0,b:3},{id:"b",a:1,b:3},{id:"c",a:2,b:void 0},{id:"d",a:-2,b:200}],[["a","asc"],["b","desc"]]),["d","a","b","c"]);lt.equal(t([{id:"a",type:"number"}],[{id:"a",a:0},{id:"b",a:1},{id:"c",a:void 0}],[["a","asc"]]),["a","c","b"]);{const t=oe([{id:"a",type:"string"}],[{id:"a",a:"a"},{id:"b",a:"a"},{id:"c",a:"b"}],[["a","asc"]]);lt.equal(t[2].id,"c"),lt.equal(t.map((t=>t._weights.a)),[0,0,1])}}));class ce extends V{constructor(t){super(),Q(this,t,ae,le,s,{column:6,format:7,width:0,state:5})}}function ue(t,e,n){const o=t.slice();return o[5]=e[n],o[7]=n,o}function fe(t){let e,n,o;function r(e){t[4](e)}let s={column:t[5],format:t[2][t[7]],width:t[3][t[7]]};return void 0!==t[0]&&(s.state=t[0]),e=new ce({props:s}),k.push((()=>W(e,"state",r))),{c(){K(e.$$.fragment)},m(t,n){U(e,t,n),o=!0},p(t,o){const r={};2&o&&(r.column=t[5]),6&o&&(r.format=t[2][t[7]]),10&o&&(r.width=t[3][t[7]]),!n&&1&o&&(n=!0,r.state=t[0],S((()=>n=!1))),e.$set(r)},i(t){o||(F(e.$$.fragment,t),o=!0)},o(t){P(e.$$.fragment,t),o=!1},d(t){H(e,t)}}}function de(e){let n;return{c(){n=c("th"),$(n,"width",e[3][e[7]]+"%")},m(t,e){l(t,n,e)},p(t,e){10&e&&$(n,"width",t[3][t[7]]+"%")},i:t,o:t,d(t){t&&a(n)}}}function me(t,e){let n,o,r,s,i;const c=[de,fe],u=[];function f(t,e){return"_i"==t[5].id?0:1}return o=f(e),r=u[o]=c[o](e),{key:t,first:null,c(){n=d(),r.c(),s=d(),this.first=n},m(t,e){l(t,n,e),u[o].m(t,e),l(t,s,e),i=!0},p(t,n){let i=o;o=f(e=t),o===i?u[o].p(e,n):(z(),P(u[i],1,1,(()=>{u[i]=null})),L(),r=u[o],r?r.p(e,n):(r=u[o]=c[o](e),r.c()),F(r,1),r.m(s.parentNode,s))},i(t){i||(F(r),i=!0)},o(t){P(r),i=!1},d(t){t&&a(n),u[o].d(t),t&&a(s)}}}function pe(t){let e,n,o=[],r=new Map,s=t[1];const i=t=>t[5].id;for(let e=0;e<s.length;e+=1){let n=ue(t,s,e),l=i(n);r.set(l,o[e]=me(l,n))}return{c(){e=c("tr");for(let t=0;t<o.length;t+=1)o[t].c()},m(t,r){l(t,e,r);for(let t=0;t<o.length;t+=1)o[t].m(e,null);n=!0},p(t,[n]){15&n&&(s=t[1],z(),o=R(o,n,i,1,t,s,r,e,I,me,null,ue),L())},i(t){if(!n){for(let t=0;t<s.length;t+=1)F(o[t]);n=!0}},o(t){for(let t=0;t<o.length;t+=1)P(o[t]);n=!1},d(t){t&&a(e);for(let t=0;t<o.length;t+=1)o[t].d()}}}function he(t,e,n){let{columns:o}=e,{formats:r}=e,{widths:s}=e,{state:i}=e;return t.$$set=t=>{"columns"in t&&n(1,o=t.columns),"formats"in t&&n(2,r=t.formats),"widths"in t&&n(3,s=t.widths),"state"in t&&n(0,i=t.state)},[i,o,r,s,function(t){i=t,n(0,i)}]}class ge extends V{constructor(t){super(),Q(this,t,he,pe,s,{columns:1,formats:2,widths:3,state:0})}}function we(t,e,n){const o=t.slice();return o[5]=e[n],o[7]=n,o}function $e(t){let e,n,o,r,s;const u=[ye,ve],d=[];function m(t,e){return"_converted"in t[2]&&t[5].id in t[2]._converted?0:1}return n=m(t),o=d[n]=u[n](t),{c(){e=c("td"),o.c(),r=f()},m(t,o){l(t,e,o),d[n].m(e,null),i(e,r),s=!0},p(t,s){let i=n;n=m(t),n===i?d[n].p(t,s):(z(),P(d[i],1,1,(()=>{d[i]=null})),L(),o=d[n],o?o.p(t,s):(o=d[n]=u[n](t),o.c()),F(o,1),o.m(e,r))},i(t){s||(F(o),s=!0)},o(t){P(o),s=!1},d(t){t&&a(e),d[n].d()}}}function be(e){let n,o,r=e[2]._i+1+"";return{c(){n=c("td"),o=u(r),h(n,"class","text-right")},m(t,e){l(t,n,e),i(n,o)},p(t,e){4&e&&r!==(r=t[2]._i+1+"")&&g(o,r)},i:t,o:t,d(t){t&&a(n)}}}function ve(t){let e,n,o;var r=t[1][t[7]][0].default;function s(t){return{props:{options:t[1][t[7]][1],value:t[2][t[5].id]}}}return r&&(e=new r(s(t))),{c(){e&&K(e.$$.fragment),n=d()},m(t,r){e&&U(e,t,r),l(t,n,r),o=!0},p(t,o){const i={};if(3&o&&(i.options=t[1][t[7]][1]),5&o&&(i.value=t[2][t[5].id]),r!==(r=t[1][t[7]][0].default)){if(e){z();const t=e;P(t.$$.fragment,1,0,(()=>{H(t,1)})),L()}r?(e=new r(s(t)),K(e.$$.fragment),F(e.$$.fragment,1),U(e,n.parentNode,n)):e=null}else r&&e.$set(i)},i(t){o||(e&&F(e.$$.fragment,t),o=!0)},o(t){e&&P(e.$$.fragment,t),o=!1},d(t){t&&a(n),e&&H(e,t)}}}function ye(t){let e,n,o;var r=t[1][t[7]][0].default;function s(t){return{props:{options:t[1][t[7]][1],value:t[2][t[5].id],converted:t[2]._converted[t[5].id]}}}return r&&(e=new r(s(t))),{c(){e&&K(e.$$.fragment),n=d()},m(t,r){e&&U(e,t,r),l(t,n,r),o=!0},p(t,o){const i={};if(3&o&&(i.options=t[1][t[7]][1]),5&o&&(i.value=t[2][t[5].id]),5&o&&(i.converted=t[2]._converted[t[5].id]),r!==(r=t[1][t[7]][0].default)){if(e){z();const t=e;P(t.$$.fragment,1,0,(()=>{H(t,1)})),L()}r?(e=new r(s(t)),K(e.$$.fragment),F(e.$$.fragment,1),U(e,n.parentNode,n)):e=null}else r&&e.$set(i)},i(t){o||(e&&F(e.$$.fragment,t),o=!0)},o(t){e&&P(e.$$.fragment,t),o=!1},d(t){t&&a(n),e&&H(e,t)}}}function xe(t,e){let n,o,r,s,i;const c=[be,$e],u=[];function f(t,e){return"_i"==t[5].id?0:1}return o=f(e),r=u[o]=c[o](e),{key:t,first:null,c(){n=d(),r.c(),s=d(),this.first=n},m(t,e){l(t,n,e),u[o].m(t,e),l(t,s,e),i=!0},p(t,n){let i=o;o=f(e=t),o===i?u[o].p(e,n):(z(),P(u[i],1,1,(()=>{u[i]=null})),L(),r=u[o],r?r.p(e,n):(r=u[o]=c[o](e),r.c()),F(r,1),r.m(s.parentNode,s))},i(t){i||(F(r),i=!0)},o(t){P(r),i=!1},d(t){t&&a(n),u[o].d(t),t&&a(s)}}}function ke(t){let e,n,o,s,i,u=[],f=new Map,d=t[0];const p=t=>t[5].id;for(let e=0;e<d.length;e+=1){let n=we(t,d,e),o=p(n);f.set(o,u[e]=xe(o,n))}return{c(){e=c("tr");for(let t=0;t<u.length;t+=1)u[t].c();h(e,"class",n=t[3]?"bg-gray-100":"")},m(n,a){l(n,e,a);for(let t=0;t<u.length;t+=1)u[t].m(e,null);o=!0,s||(i=m(e,"click",(function(){r(t[4])&&t[4].apply(this,arguments)})),s=!0)},p(r,[s]){t=r,7&s&&(d=t[0],z(),u=R(u,s,p,1,t,d,f,e,I,xe,null,we),L()),(!o||8&s&&n!==(n=t[3]?"bg-gray-100":""))&&h(e,"class",n)},i(t){if(!o){for(let t=0;t<d.length;t+=1)F(u[t]);o=!0}},o(t){for(let t=0;t<u.length;t+=1)P(u[t]);o=!1},d(t){t&&a(e);for(let t=0;t<u.length;t+=1)u[t].d();s=!1,i()}}}function _e(t,e,n){let{columns:o}=e,{formats:r}=e,{row:s}=e,{selected:i}=e,{onSelect:l}=e;return t.$$set=t=>{"columns"in t&&n(0,o=t.columns),"formats"in t&&n(1,r=t.formats),"row"in t&&n(2,s=t.row),"selected"in t&&n(3,i=t.selected),"onSelect"in t&&n(4,l=t.onSelect)},[o,r,s,i,l]}class qe extends V{constructor(t){super(),Q(this,t,_e,ke,s,{columns:0,formats:1,row:2,selected:3,onSelect:4})}}function Ee(e){let n,r,s,d,p,g,$,b,v,y,x,k,_=`<svg xmlns="http://www.w3.org/2000/svg" class="${"h-4 w-4 text-gray-900"}" viewBox="0 0 20 20" fill="currentColor">\n  <path fill-rule="evenodd" d="M12.316 3.051a1 1 0 01.633 1.265l-4 12a1 1 0 11-1.898-.632l4-12a1 1 0 011.265-.633zM5.707 6.293a1 1 0 010 1.414L3.414 10l2.293 2.293a1 1 0 11-1.414 1.414l-3-3a1 1 0 010-1.414l3-3a1 1 0 011.414 0zm8.586 0a1 1 0 011.414 0l3 3a1 1 0 010 1.414l-3 3a1 1 0 11-1.414-1.414L16.586 10l-2.293-2.293a1 1 0 010-1.414z" clip-rule="evenodd" />\n</svg>`;let q,E;return{c(){n=c("div"),r=c("div"),s=f(),d=c("div"),p=c("input"),$=f(),b=c("button"),v=u("W"),x=f(),k=c("button"),h(r,"class","flex items-center"),h(p,"class",g=e[2]+" rounded border border-gray-300 text-sm outline-none py-1 px-1 leading-4"),h(p,"type","text"),h(p,"placeholder","Filter"),h(b,"class",y=e[2]+" focus:outline-none rounded border text-sm px-1 "+(e[0].wsort?"bg-gray-900 border-gray-900 text-white":"border-gray-300 text-gray-900")),h(b,"title",e[4]),h(k,"class","focus:outline-none"),h(d,"class","flex items-center space-x-1"),h(n,"class","flex items-center justify-between my-1 mx-1")},m(t,o){l(t,n,o),i(n,r),i(n,s),i(n,d),i(d,p),w(p,e[1]),i(d,$),i(d,b),i(b,v),i(d,x),i(d,k),k.innerHTML=_,q||(E=[m(p,"input",e[5]),m(p,"keyup",e[3]),m(b,"click",e[6]),m(k,"click",e[7])],q=!0)},p(t,[e]){4&e&&g!==(g=t[2]+" rounded border border-gray-300 text-sm outline-none py-1 px-1 leading-4")&&h(p,"class",g),2&e&&p.value!==t[1]&&w(p,t[1]),5&e&&y!==(y=t[2]+" focus:outline-none rounded border text-sm px-1 "+(t[0].wsort?"bg-gray-900 border-gray-900 text-white":"border-gray-300 text-gray-900"))&&h(b,"class",y)},i:t,o:t,d(t){t&&a(n),q=!1,o(E)}}}function je(t,e,n){let o,{state:r}=e,s=r.query;const i=function(t,e){let n;return(...o)=>{n&&clearTimeout(n),n=setTimeout((()=>t(...o)),e)}}((()=>{n(0,r.query=s,r)}),200),l=['Weighted sorting. "Smart", weighted, ranked sorting, instead of normal sorting.',"Applies only when multiple columns are sorted. It works similar to how humans normally compare products with many attributes to find the best one.","Example: find countries with highest salaries, lowest taxes and lowest real estate prices - ordinary sorting would be useless, while weighted sorting would sort the countries in a 'smart' way, similar to how human would do.","Missing values threated as average, like if we don't have tax rate for country, we guess that it probably should be somewhat average. For non number comparable elements sort rank used as weight. ifferent range of values for different columns normalised into [-1..1] range as 'nw = (w - median(w)) / 0.9-quantile(variance(w))*1.11' and limiting min/max outliers by [-1..1].",'- Undefined values threated as average\n- Rank for same values should be the same, like ["a", "a", "b"] should be [0, 0, 1], not [0, 1, 2]\n- Different range of values for different columns normalised into [-1..1] range as\n      nw = (w - median(w)) / 0.9-quantile(variance(w))*1.11 and limiting min/max outliers by [-1..1].'].join("\n\n");return t.$$set=t=>{"state"in t&&n(0,r=t.state)},t.$$.update=()=>{1&t.$$.dirty&&n(2,o=r.show_json?"invisible":"")},[r,s,o,i,l,function(){s=this.value,n(1,s)},()=>n(0,r.wsort=!r.wsort,r),()=>n(0,r.show_json=!r.show_json,r)]}class Me extends V{constructor(t){super(),Q(this,t,je,Ee,s,{state:0})}}function Se(t,e,n){const o=t.slice();return o[1]=e[n],o}function Ae(e){let n;return{c(){n=c("div"),n.textContent="unknown message type"},m(t,e){l(t,n,e)},p:t,d(t){t&&a(n)}}}function Oe(t){let e,n,o,r,s=t[1].message+"";return{c(){e=c("div"),n=c("span"),n.textContent="error",o=f(),r=u(s),h(n,"class","bg-red-400 px-2 rounded")},m(t,s){l(t,e,s),i(e,n),i(e,o),i(e,r)},p(t,e){1&e&&s!==(s=t[1].message+"")&&g(r,s)},d(t){t&&a(e)}}}function Ce(t){let e,n,o,r,s=t[1].message+"";return{c(){e=c("div"),n=c("span"),n.textContent="warn",o=f(),r=u(s),h(n,"class","bg-yellow-400 px-2 rounded")},m(t,s){l(t,e,s),i(e,n),i(e,o),i(e,r)},p(t,e){1&e&&s!==(s=t[1].message+"")&&g(r,s)},d(t){t&&a(e)}}}function Ne(t){let e;function n(t,e){return"warn"==t[1].type?Ce:"error"==t[1].type?Oe:Ae}let o=n(t),r=o(t);return{c(){r.c(),e=d()},m(t,n){r.m(t,n),l(t,e,n)},p(t,s){o===(o=n(t))&&r?r.p(t,s):(r.d(1),r=o(t),r&&(r.c(),r.m(e.parentNode,e)))},d(t){r.d(t),t&&a(e)}}}function Te(e){let n,o=e[0],r=[];for(let t=0;t<o.length;t+=1)r[t]=Ne(Se(e,o,t));return{c(){n=c("div");for(let t=0;t<r.length;t+=1)r[t].c();h(n,"class","text-sm mt-1 mx-1")},m(t,e){l(t,n,e);for(let t=0;t<r.length;t+=1)r[t].m(n,null)},p(t,[e]){if(1&e){let s;for(o=t[0],s=0;s<o.length;s+=1){const i=Se(t,o,s);r[s]?r[s].p(i,e):(r[s]=Ne(i),r[s].c(),r[s].m(n,null))}for(;s<r.length;s+=1)r[s].d(1);r.length=o.length}},i:t,o:t,d(t){t&&a(n),function(t,e){for(let n=0;n<t.length;n+=1)t[n]&&t[n].d(e)}(r,t)}}}function Je(t,e,n){let{messages:o}=e;return t.$$set=t=>{"messages"in t&&n(0,o=t.messages)},[o]}class ze extends V{constructor(t){super(),Q(this,t,Je,Te,s,{messages:0})}}function Le(t,e,n){const o=t.slice();return o[16]=e[n],o}function Fe(t,e){let n,o,r;function s(...t){return e[13](e[16],...t)}return o=new qe({props:{columns:e[5],formats:e[7],row:e[16],selected:e[2].has(e[16]._i),onSelect:s}}),{key:t,first:null,c(){n=d(),K(o.$$.fragment),this.first=n},m(t,e){l(t,n,e),U(o,t,e),r=!0},p(t,n){e=t;const r={};16&n&&(r.row=e[16]),20&n&&(r.selected=e[2].has(e[16]._i)),16&n&&(r.onSelect=s),o.$set(r)},i(t){r||(F(o.$$.fragment,t),r=!0)},o(t){P(o.$$.fragment,t),r=!1},d(t){t&&a(n),H(o,t)}}}function Pe(t){let e,n,o;return{c(){e=c("div"),n=c("textarea"),h(n,"class","w-full h-full focus:outline-none"),n.readOnly=!0,$(n,"resize","none"),n.value=o=ct(t[0]),h(e,"class","plot-table-json rounded border border-gray-200 text-xs overflow-scroll")},m(t,o){l(t,e,o),i(e,n)},p(t,e){1&e&&o!==(o=ct(t[0]))&&(n.value=o)},d(t){t&&a(e)}}}function Be(e){let n,o;return n=new ze({props:{messages:e[6]}}),{c(){K(n.$$.fragment)},m(t,e){U(n,t,e),o=!0},p:t,i(t){o||(F(n.$$.fragment,t),o=!0)},o(t){P(n.$$.fragment,t),o=!1},d(t){H(n,t)}}}function De(t){let e,n,o,r,s,u,p,g,w,$,b,v,y,x,_,q,E=[],j=new Map;function M(e){t[11](e)}let A={};function O(e){t[12](e)}void 0!==t[1]&&(A.state=t[1]),r=new Me({props:A}),k.push((()=>W(r,"state",M)));let C={columns:t[5],formats:t[7],widths:t[8]};void 0!==t[1]&&(C.state=t[1]),g=new ge({props:C}),k.push((()=>W(g,"state",O)));let N=t[4];const T=t=>t[16]._i;for(let e=0;e<N.length;e+=1){let n=Le(t,N,e),o=T(n);j.set(o,E[e]=Fe(o,n))}let J=t[1].show_json&&Pe(t),B=0!=t[0].warnings&&Be(t);return{c(){e=c("table"),n=c("tr"),o=c("td"),K(r.$$.fragment),p=f(),K(g.$$.fragment),$=f();for(let t=0;t<E.length;t+=1)E[t].c();b=f(),J&&J.c(),v=f(),B&&B.c(),y=d(),h(o,"colspan",t[5].length),h(n,"class",u="plot-table-toolbar "+(!t[3]&&"invisible")+" "),h(e,"class","plot-table font-mono")},m(s,a){l(s,e,a),i(e,n),i(n,o),U(r,o,null),i(e,p),U(g,e,null),i(e,$);for(let t=0;t<E.length;t+=1)E[t].m(e,null);i(e,b),J&&J.m(e,null),l(s,v,a),B&&B.m(s,a),l(s,y,a),x=!0,_||(q=m(e,"click",t[14]),_=!0)},p(t,[o]){const i={};!s&&2&o&&(s=!0,i.state=t[1],S((()=>s=!1))),r.$set(i),(!x||8&o&&u!==(u="plot-table-toolbar "+(!t[3]&&"invisible")+" "))&&h(n,"class",u);const l={};!w&&2&o&&(w=!0,l.state=t[1],S((()=>w=!1))),g.$set(l),692&o&&(N=t[4],z(),E=R(E,o,T,1,t,N,j,e,I,Fe,b,Le),L()),t[1].show_json?J?J.p(t,o):(J=Pe(t),J.c(),J.m(e,null)):J&&(J.d(1),J=null),0!=t[0].warnings?B?(B.p(t,o),1&o&&F(B,1)):(B=Be(t),B.c(),F(B,1),B.m(y.parentNode,y)):B&&(z(),P(B,1,1,(()=>{B=null})),L())},i(t){if(!x){F(r.$$.fragment,t),F(g.$$.fragment,t);for(let t=0;t<N.length;t+=1)F(E[t]);F(B),x=!0}},o(t){P(r.$$.fragment,t),P(g.$$.fragment,t);for(let t=0;t<E.length;t+=1)P(E[t]);P(B),x=!1},d(t){t&&a(e),H(r),H(g);for(let t=0;t<E.length;t+=1)E[t].d();J&&J.d(),t&&a(v),B&&B.d(t),t&&a(y),_=!1,q()}}}function Ie(t,e,n){let o,r,{options:s}=e,{columns:i,rows:l,messages:a,formats:c}=Qt(s.columns,s.alter_columns,s.rows,s._i||!1),u=Xt(i,l),f={query:s.query||"",wsort:!!s.wsort,sortable:0!=s.sortable,order:s.order||[],show_json:!1},d=new Set;function m(t,e){!function(t,e,n,o){const r=new Set(n);if(t.metaKey)r.has(e)?r.delete(e):r.add(e);else{const t=r.has(e)&&1==r.size;r.clear(),t||r.add(e)}o(r)}(t,e,d,(t=>n(2,d=t)))}let p=!!s.toolbar;return t.$$set=t=>{"options"in t&&n(0,s=t.options)},t.$$.update=()=>{2&t.$$.dirty&&n(10,o=Zt(i,l,f.query)),1026&t.$$.dirty&&n(4,r=(f.wsort?oe:ne)(i,o,f.order))},[s,f,d,p,r,i,a,c,u,m,o,function(t){f=t,n(1,f)},function(t){f=t,n(1,f)},(t,e)=>m(e,t._i),()=>n(3,p=!0)]}class Re extends V{constructor(t){super(),Q(this,t,Ie,De,s,{options:0})}}function We(e){let n,o,r,s;return{c(){n=c("div"),o=c("span"),o.textContent="Error",r=u(" - can't load "),s=u(e[0]),h(o,"class","text-red-600 font-bold")},m(t,e){l(t,n,e),i(n,o),i(n,r),i(n,s)},p(t,e){1&e&&g(s,t[0])},i:t,o:t,d(t){t&&a(n)}}}function Ke(t){let e,n,o,r,s,d=t[2](t[0],t[3])+"";return r=new Re({props:{options:t[3]}}),{c(){e=c("h1"),n=u(d),o=f(),K(r.$$.fragment),h(e,"class","text-2xl mb-4")},m(t,a){l(t,e,a),i(e,n),l(t,o,a),U(r,t,a),s=!0},p(t,e){(!s||3&e)&&d!==(d=t[2](t[0],t[3])+"")&&g(n,d);const o={};2&e&&(o.options=t[3]),r.$set(o)},i(t){s||(F(r.$$.fragment,t),s=!0)},o(t){P(r.$$.fragment,t),s=!1},d(t){t&&a(e),t&&a(o),H(r,t)}}}function Ue(e){let n;return{c(){n=c("div"),n.textContent="Loading..."},m(t,e){l(t,n,e)},p:t,i:t,o:t,d(t){t&&a(n)}}}function He(t){let e,n,o,r={ctx:t,current:null,token:null,hasCatch:!0,pending:Ue,then:Ke,catch:We,value:3,error:4,blocks:[,,,]};return B(n=t[1],r),{c(){e=c("div"),r.block.c(),h(e,"class","mx-5 my-2")},m(t,n){l(t,e,n),r.block.m(e,r.anchor=null),r.mount=()=>e,r.anchor=null,o=!0},p(e,[o]){t=e,r.ctx=t,2&o&&n!==(n=t[1])&&B(n,r)||function(t,e,n){const o=e.slice(),{resolved:r}=t;t.current===t.then&&(o[t.value]=r),t.current===t.catch&&(o[t.error]=r),t.block.p(o,n)}(r,t,o)},i(t){o||(F(r.block),o=!0)},o(t){for(let t=0;t<3;t+=1){P(r.blocks[t])}o=!1},d(t){t&&a(e),r.block.d(),r.token=null,r=null}}}function Ge(t,e,n){let{path:o}=e,{datap:r}=e;function s(t,e){return e.title||e.id||function(t,e){if(void 0===e){if(t.length<1)throw new Error("can't get last elements from empty list");return t[t.length-1]}if(t.length<e)throw new Error(`can't get last ${e} elements from list of length ${t.length}`);return t.slice(t.length-e,t.length)}(t.split("/")).replace(/\.[^\.]+$/,"")}return t.$$set=t=>{"path"in t&&n(0,o=t.path),"datap"in t&&n(1,r=t.datap)},t.$$.update=()=>{3&t.$$.dirty&&r.then((t=>document.title=s(o,t)))},[o,r,s]}const Qe=function(){let t=window.location.pathname;return t.startsWith("/")||(t+="/"),t=t.replace(/:([^:]+)$/i,""),/\.[^\/]+$/.test(t)||(t+=".json"),t}();new class extends V{constructor(t){super(),Q(this,t,Ge,He,s,{path:0,datap:1})}}({target:document.body,props:{path:Qe,datap:async function(t){let e=await fetch(function(t,e={}){const n=[];for(const t in e){const o=e[t];null!=t&&null!=o&&n.push(`${encodeURIComponent(t)}=${encodeURIComponent(""+e[t])}`)}return n.length>0?`${t}${t.includes("?")?"&":"?"}${n.join("&")}`:t}(t,{clearcache:Math.random()}));return await e.json()}(Qe)}})}();
